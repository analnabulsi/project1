<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dubai Duty Free Tennis - Guess the Balls</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: "Segoe UI", Arial, sans-serif;
        background-color: #f4f7f6;
        color: #333;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        text-align: center;
      }
      .navbar {
        background-color: #002d62;
        padding: 10px 20px;
        color: white;
      }
      .nav-container {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .logo img {
        height: 40px;
        margin: 0 5px;
        border-radius: 4px;
      }
      #tennis {
        width: 100%;
        max-width: 500px;
        border-radius: 12px;
        margin: 20px 0;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      /* Countdown */
      .countdown-section {
        max-width: 500px;
        margin: 20px auto;
      }
      .timer-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
      }
      .card {
        background: #fff;
        border-radius: 8px;
        padding: 15px 5px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border: 1px solid #eee;
      }
      .card span {
        display: block;
        font-size: 1.8rem;
        font-weight: bold;
        color: #002d62;
      }
      .card p {
        margin: 0;
        font-size: 0.7rem;
        text-transform: uppercase;
        color: #d31d32;
        font-weight: 700;
      }

      /* Form */
      #guessForm {
        display: flex;
        flex-direction: column;
        gap: 15px;
        max-width: 400px;
        margin: 30px auto;
        text-align: left;
      }
      input[type="text"],
      input[type="email"],
      input[type="number"],
      input[type="tel"] {
        padding: 12px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 16px;
        width: 100%;
        box-sizing: border-box;
      }

      /* Phone row */
      .phone-row {
        display: flex;
        gap: 8px;
      }
      .phone-row select {
        padding: 12px 6px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 14px;
        background: white;
        cursor: pointer;
        width: 135px;
        flex-shrink: 0;
      }
      .phone-row input[type="tel"] {
        flex: 1;
        width: auto;
      }

      button {
        background-color: #002d62;
        color: white;
        padding: 15px;
        border: none;
        border-radius: 6px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
        width: 100%;
      }
      button:hover {
        background-color: #004080;
      }
      button:disabled {
        background-color: #cccccc;
        cursor: not-allowed;
      }
      .form-disabled {
        opacity: 0.5;
        pointer-events: none;
        user-select: none;
      }
      #alreadyDoneMsg {
        display: none;
        background-color: #fff3cd;
        color: #856404;
        padding: 14px;
        border-radius: 8px;
        text-align: center;
        font-weight: bold;
        border: 1px solid #ffc107;
        max-width: 400px;
        margin: 0 auto 10px;
      }

      #successMsg {
        display: none;
        background-color: #d4edda;
        color: #155724;
        padding: 12px;
        border-radius: 6px;
        text-align: center;
        font-weight: bold;
      }
      #errorMsg {
        display: none;
        background-color: #f8d7da;
        color: #721c24;
        padding: 12px;
        border-radius: 6px;
        text-align: center;
        font-weight: bold;
      }

      footer {
        background-color: #002d62;
        padding: 15px 10px;
        text-align: center;
        margin-top: 40px;
        color: white;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <nav class="navbar">
      <div class="nav-container">
        <div class="logo">
          <img src="logo1.jpg" alt="Logo 1" />
          <img src="logo2.jpg" alt="Logo 2" />
        </div>
      </div>
    </nav>

    <div class="container">
      <header>
        <h1>Dubai Duty Free Tennis Championships</h1>
        <img src="guessball.jpg" alt="Guess the ball" id="tennis" />
        <p>Guess the Number of Balls and Win Exciting Prizes!</p>
      </header>

      <div class="countdown-section">
        <div class="timer-grid">
          <div class="card">
            <span id="days">00</span>
            <p>Days</p>
          </div>
          <div class="card">
            <span id="hours">00</span>
            <p>Hours</p>
          </div>
          <div class="card">
            <span id="minutes">00</span>
            <p>Mins</p>
          </div>
          <div class="card">
            <span id="seconds">00</span>
            <p>Secs</p>
          </div>
        </div>
      </div>

      <main>
        <div id="alreadyDoneMsg">
          âœ… You have already submitted your guess. Only one entry per person is
          allowed.
        </div>
        <form id="guessForm">
          <input
            type="text"
            name="name"
            placeholder="Name"
            required
            pattern="^[A-Za-z\s]+"
            title="Name should contain only letters and spaces"
          />
          <input type="email" name="email" placeholder="Email" required />

          <!-- Phone: country code dropdown + number input -->
          <div class="phone-row">
            <select id="countryCode">
              <option value="+971">ğŸ‡¦ğŸ‡ª UAE +971</option>
              <option value="+966">ğŸ‡¸ğŸ‡¦ KSA +966</option>
              <option value="+974">ğŸ‡¶ğŸ‡¦ QAT +974</option>
              <option value="+965">ğŸ‡°ğŸ‡¼ KWT +965</option>
              <option value="+973">ğŸ‡§ğŸ‡­ BHR +973</option>
              <option value="+968">ğŸ‡´ğŸ‡² OMN +968</option>
              <option value="+20">ğŸ‡ªğŸ‡¬ EGY +20</option>
              <option value="+962">ğŸ‡¯ğŸ‡´ JOR +962</option>
              <option value="+961">ğŸ‡±ğŸ‡§ LBN +961</option>
              <option value="+963">ğŸ‡¸ğŸ‡¾ SYR +963</option>
              <option value="+964">ğŸ‡®ğŸ‡¶ IRQ +964</option>
              <option value="+967">ğŸ‡¾ğŸ‡ª YEM +967</option>
              <option value="+212">ğŸ‡²ğŸ‡¦ MAR +212</option>
              <option value="+213">ğŸ‡©ğŸ‡¿ DZA +213</option>
              <option value="+216">ğŸ‡¹ğŸ‡³ TUN +216</option>
              <option value="+249">ğŸ‡¸ğŸ‡© SDN +249</option>
              <option value="+44">ğŸ‡¬ğŸ‡§ GBR +44</option>
              <option value="+1">ğŸ‡ºğŸ‡¸ USA +1</option>
              <option value="+33">ğŸ‡«ğŸ‡· FRA +33</option>
              <option value="+49">ğŸ‡©ğŸ‡ª DEU +49</option>
              <option value="+39">ğŸ‡®ğŸ‡¹ ITA +39</option>
              <option value="+34">ğŸ‡ªğŸ‡¸ ESP +34</option>
              <option value="+31">ğŸ‡³ğŸ‡± NLD +31</option>
              <option value="+32">ğŸ‡§ğŸ‡ª BEL +32</option>
              <option value="+41">ğŸ‡¨ğŸ‡­ CHE +41</option>
              <option value="+46">ğŸ‡¸ğŸ‡ª SWE +46</option>
              <option value="+47">ğŸ‡³ğŸ‡´ NOR +47</option>
              <option value="+45">ğŸ‡©ğŸ‡° DNK +45</option>
              <option value="+358">ğŸ‡«ğŸ‡® FIN +358</option>
              <option value="+91">ğŸ‡®ğŸ‡³ IND +91</option>
              <option value="+92">ğŸ‡µğŸ‡° PAK +92</option>
              <option value="+880">ğŸ‡§ğŸ‡© BGD +880</option>
              <option value="+94">ğŸ‡±ğŸ‡° LKA +94</option>
              <option value="+977">ğŸ‡³ğŸ‡µ NPL +977</option>
              <option value="+63">ğŸ‡µğŸ‡­ PHL +63</option>
              <option value="+62">ğŸ‡®ğŸ‡© IDN +62</option>
              <option value="+60">ğŸ‡²ğŸ‡¾ MYS +60</option>
              <option value="+65">ğŸ‡¸ğŸ‡¬ SGP +65</option>
              <option value="+66">ğŸ‡¹ğŸ‡­ THA +66</option>
              <option value="+84">ğŸ‡»ğŸ‡³ VNM +84</option>
              <option value="+86">ğŸ‡¨ğŸ‡³ CHN +86</option>
              <option value="+81">ğŸ‡¯ğŸ‡µ JPN +81</option>
              <option value="+82">ğŸ‡°ğŸ‡· KOR +82</option>
              <option value="+90">ğŸ‡¹ğŸ‡· TUR +90</option>
              <option value="+98">ğŸ‡®ğŸ‡· IRN +98</option>
              <option value="+7">ğŸ‡·ğŸ‡º RUS +7</option>
              <option value="+380">ğŸ‡ºğŸ‡¦ UKR +380</option>
              <option value="+48">ğŸ‡µğŸ‡± POL +48</option>
              <option value="+55">ğŸ‡§ğŸ‡· BRA +55</option>
              <option value="+52">ğŸ‡²ğŸ‡½ MEX +52</option>
              <option value="+54">ğŸ‡¦ğŸ‡· ARG +54</option>
              <option value="+57">ğŸ‡¨ğŸ‡´ COL +57</option>
              <option value="+61">ğŸ‡¦ğŸ‡º AUS +61</option>
              <option value="+64">ğŸ‡³ğŸ‡¿ NZL +64</option>
              <option value="+27">ğŸ‡¿ğŸ‡¦ ZAF +27</option>
              <option value="+234">ğŸ‡³ğŸ‡¬ NGA +234</option>
              <option value="+254">ğŸ‡°ğŸ‡ª KEN +254</option>
              <option value="+233">ğŸ‡¬ğŸ‡­ GHA +233</option>
              <option value="+251">ğŸ‡ªğŸ‡¹ ETH +251</option>
            </select>
            <input
              type="tel"
              id="mobileNumber"
              placeholder="Mobile Number"
              required
              pattern="[0-9]{5,15}"
              title="Enter digits only (5â€“15 digits)"
            />
          </div>

          <!-- Hidden field stores full number sent to Google Sheets -->
          <input type="hidden" name="mobile" id="mobileFullNumber" />

          <input
            type="number"
            name="guess"
            placeholder="Your Guess"
            required
            min="1"
            title="Please enter a number greater than 0"
          />

          <label
            style="
              font-size: 12px;
              display: flex;
              align-items: flex-start;
              gap: 8px;
            "
          >
            <input type="checkbox" required />
            <span>
              I acknowledge that the information collected in this form will be
              used solely to process the submission for the "Guess the Number of
              Balls" competition. It will be accessible only to authorized
              personnel who require it to administer the competition and
              maintain the system. All data will be handled in accordance with
              the <span style="color: #002d62"><u>Privacy Policy.</u></span>
            </span>
          </label>

          <button type="submit" id="submitBtn">Submit Guess</button>
          <div id="successMsg">âœ… Your guess has been recorded. Good luck!</div>
          <div id="errorMsg">
            âš ï¸ This mobile number has already been submitted. Only one entry per
            person is allowed.
          </div>
        </form>
      </main>
    </div>

    <footer>
      <p>&copy; 2026 Dubai Duty Free Tennis. All Rights Reserved.</p>
    </footer>

    <script>
      // â”€â”€ 1. COUNTDOWN TIMER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const targetDate = new Date("2026-02-28T19:00:00+04:00"); // 28 Feb 7:00 PM UAE time

      function updateCountdown() {
        const now = new Date();
        const diff = targetDate - now;

        if (diff <= 0) {
          document.getElementById("days").textContent = "00";
          document.getElementById("hours").textContent = "00";
          document.getElementById("minutes").textContent = "00";
          document.getElementById("seconds").textContent = "00";
          return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor(
          (diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60),
        );
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        document.getElementById("days").textContent = String(days).padStart(
          2,
          "0",
        );
        document.getElementById("hours").textContent = String(hours).padStart(
          2,
          "0",
        );
        document.getElementById("minutes").textContent = String(
          minutes,
        ).padStart(2, "0");
        document.getElementById("seconds").textContent = String(
          seconds,
        ).padStart(2, "0");
      }

      updateCountdown();
      setInterval(updateCountdown, 1000);

      // â”€â”€ 2. FORM SUBMISSION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbyPaSHc73USQjirA5wTJjmxDtzqg8KjMlRIsnhmgLRnoXlL0yyoSFNWy4aztrl_JGw/exec";
      const form = document.getElementById("guessForm");
      const btn = document.getElementById("submitBtn");
      const successMsg = document.getElementById("successMsg");
      const errorMsg = document.getElementById("errorMsg");
      const alreadyDoneMsg = document.getElementById("alreadyDoneMsg");

      // â”€â”€ Lock form permanently (called after success) â”€â”€
      function lockFormPermanently() {
        form.classList.add("form-disabled");
        btn.disabled = true;
        btn.innerText = "Already Submitted";
        alreadyDoneMsg.style.display = "block";
      }

      // â”€â”€ On page load: if this device already submitted, lock immediately â”€â”€
      if (localStorage.getItem("hasSubmitted") === "true") {
        lockFormPermanently();
      }

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        // Build full international number (strip leading zero from local number)
        const code = document.getElementById("countryCode").value;
        const localNum = document
          .getElementById("mobileNumber")
          .value.trim()
          .replace(/^0+/, "");
        const fullNumber = code + localNum;

        // Set hidden field
        document.getElementById("mobileFullNumber").value = fullNumber;

        // â”€â”€ DUPLICATE CHECK by mobile number â”€â”€
        const stored = JSON.parse(
          localStorage.getItem("submittedMobiles") || "[]",
        );
        if (stored.includes(fullNumber)) {
          errorMsg.style.display = "block";
          successMsg.style.display = "none";
          setTimeout(() => {
            errorMsg.style.display = "none";
          }, 7000);
          return;
        }

        btn.disabled = true;
        btn.innerText = "Sending...";
        errorMsg.style.display = "none";

        fetch(scriptURL, { method: "POST", body: new FormData(form) })
          .then(() => {
            // Save mobile number
            stored.push(fullNumber);
            localStorage.setItem("submittedMobiles", JSON.stringify(stored));
            // Mark this device as submitted â€” permanently locks the form
            localStorage.setItem("hasSubmitted", "true");

            successMsg.style.display = "block";
            form.reset();
            // Lock the form so they can never submit again
            lockFormPermanently();
          })
          .catch((error) => {
            console.error("Error!", error.message);
            alert(
              "Something went wrong. Please check your connection and try again.",
            );
            btn.disabled = false;
            btn.innerText = "Submit Guess";
          });
      });
    </script>
  </body>
</html>
